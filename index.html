<!DOCTYPE html>
<html lang="pl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Zgłoś skargę na gracza</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Roboto:wght@400;700&display=swap');

    * {
      box-sizing: border-box;
    }

    body {
      margin: 0;
      font-family: 'Roboto', sans-serif;
      background: linear-gradient(135deg, #1e3c72, #2a5298);
      color: #fff;
      min-height: 100vh;
      padding: 20px;
      display: flex;
      flex-direction: column;
      align-items: center;
    }

    header {
      text-align: center;
      max-width: 700px;
      margin-bottom: 30px;
    }

    header h1 {
      font-size: 3rem;
      margin-bottom: 10px;
      text-shadow: 2px 2px 5px rgba(0,0,0,0.7);
    }

    header p {
      font-size: 1.3rem;
      line-height: 1.4;
      text-shadow: 1px 1px 3px rgba(0,0,0,0.6);
    }

    button#openFormBtn {
      background: #ff4c4c;
      border: none;
      padding: 15px 40px;
      font-size: 1.3rem;
      font-weight: 700;
      color: white;
      border-radius: 10px;
      cursor: pointer;
      box-shadow: 0 5px 15px rgba(255, 76, 76, 0.5);
      transition: background 0.3s ease;
      margin-bottom: 25px;
      user-select: none;
    }

    button#openFormBtn:hover {
      background: #e04040;
      box-shadow: 0 8px 20px rgba(224, 64, 64, 0.8);
    }

    #complaintsList {
      width: 100%;
      max-width: 600px;
      background: rgba(255, 255, 255, 0.15);
      padding: 20px 25px;
      border-radius: 15px;
      box-shadow: inset 0 0 10px rgba(0,0,0,0.3);
      max-height: 350px;
      overflow-y: auto;
    }

    #complaintsList h3 {
      margin-top: 0;
      margin-bottom: 15px;
      color: #ffdddd;
      text-shadow: 1px 1px 2px #a00000;
      font-weight: 700;
      text-align: center;
    }

    #complaintsUl {
      list-style: none;
      padding-left: 0;
      margin: 0;
    }

    #complaintsUl li {
      background: rgba(255, 255, 255, 0.3);
      margin-bottom: 15px;
      padding: 15px 20px;
      border-radius: 12px;
      box-shadow: 0 3px 6px rgba(0,0,0,0.2);
      position: relative;
      color: #222;
      font-size: 1rem;
      line-height: 1.4;
    }

    #complaintsUl li .time {
      position: absolute;
      top: 15px;
      right: 20px;
      font-size: 0.75rem;
      font-style: italic;
      color: #444;
      user-select: none;
    }

    #complaintsUl li .playerNick {
      font-weight: 700;
      margin-bottom: 8px;
      display: block;
      color: #a30000;
    }

    #complaintsUl li button.deleteBtn {
      position: absolute;
      bottom: 15px;
      right: 20px;
      background: #a30000;
      border: none;
      color: white;
      padding: 6px 12px;
      border-radius: 8px;
      font-weight: 700;
      cursor: pointer;
      transition: background 0.3s ease;
      user-select: none;
      font-size: 0.8rem;
    }

    #complaintsUl li button.deleteBtn:hover {
      background: #ff0000;
    }

    /* MODAL */

    .modal {
      position: fixed;
      top: 0; left: 0; right: 0; bottom: 0;
      background: rgba(0,0,0,0.75);
      display: none;
      justify-content: center;
      align-items: center;
      z-index: 999;
      padding: 15px;
    }

    .modal.active {
      display: flex;
    }

    .modal-content {
      background: #222;
      border-radius: 15px;
      max-width: 480px;
      width: 100%;
      padding: 30px 35px;
      color: white;
      box-shadow: 0 8px 25px rgba(0,0,0,0.9);
      position: relative;
      font-size: 1rem;
    }

    .modal-content h2 {
      margin-top: 0;
      margin-bottom: 25px;
      font-size: 2rem;
      text-align: center;
      color: #ff4c4c;
      text-shadow: 1px 1px 4px #700000;
    }

    .form-group {
      margin-bottom: 20px;
      text-align: left;
    }

    .form-group label {
      display: block;
      margin-bottom: 7px;
      font-weight: 600;
      color: #ff9999;
      text-shadow: 1px 1px 3px #440000;
    }

    .form-group input[type="text"],
    .form-group textarea {
      width: 100%;
      padding: 12px 15px;
      border-radius: 10px;
      border: none;
      font-size: 1rem;
      resize: vertical;
      outline: none;
      box-shadow: inset 0 0 6px rgba(255,255,255,0.2);
      transition: box-shadow 0.3s ease;
      font-family: 'Roboto', sans-serif;
    }

    .form-group input[type="text"]:focus,
    .form-group textarea:focus {
      box-shadow: 0 0 10px #ff4c4c;
    }

    .form-group.error input,
    .form-group.error textarea {
      box-shadow: 0 0 10px #ff0000;
      border: 2px solid #ff0000;
    }

    .form-group .error-message {
      color: #ff5555;
      font-size: 0.85rem;
      margin-top: 5px;
      font-weight: 600;
      user-select: none;
    }

    textarea {
      min-height: 90px;
    }

    button#submitComplaint {
      width: 100%;
      background: #ff4c4c;
      border: none;
      padding: 15px 0;
      font-size: 1.3rem;
      font-weight: 700;
      color: white;
      border-radius: 12px;
      cursor: pointer;
      box-shadow: 0 6px 20px rgba(255, 76, 76, 0.6);
      transition: background 0.3s ease;
      user-select: none;
    }

    button#submitComplaint:hover {
      background: #e04040;
      box-shadow: 0 8px 25px rgba(224, 64, 64, 0.9);
    }

    /* Podziękowanie */
    .thankyou-message {
      text-align: center;
      font-size: 1.3rem;
      color: #ffdddd;
      text-shadow: 1px 1px 3px #a00000;
    }

    .thankyou-message a {
      color: #ffaaaa;
      text-decoration: underline;
      cursor: pointer;
      display: inline-block;
      margin-top: 15px;
      font-weight: 700;
    }

    .thankyou-message a:hover {
      color: #ff4c4c;
    }

  </style>
</head>
<body>

  <header>
    <h1>Zgłoś skargę na gracza</h1>
    <p>Witamy na stronie, gdzie możesz wysłać swoje skargi na graczy serwera.  
       Twoja opinia jest dla nas ważna, więc nie wahaj się wyrazić swojego zdania!</p>
  </header>

  <button id="openFormBtn" aria-haspopup="dialog" aria-controls="complaintModal">Zgłoś skargę</button>

  <section id="complaintsList" aria-live="polite" aria-label="Lista złożonych skarg">
    <h3>Lista złożonych skarg:</h3>
    <ul id="complaintsUl"></ul>
  </section>

  <!-- MODAL FORMULARZA -->
  <div class="modal" id="complaintModal" role="dialog" aria-modal="true" aria-labelledby="modalTitle" aria-describedby="modalDesc">
    <div class="modal-content">
      <h2 id="modalTitle">Zgłoś skargę na gracza</h2>

      <form id="complaintForm" novalidate>
        <div class="form-group" id="groupNick">
          <label for="playerNick">Wpisz nick gracza na którego zgłaszasz skargę</label>
          <input type="text" id="playerNick" name="playerNick" autocomplete="off" required aria-required="true" />
          <div class="error-message" aria-live="polite"></div>
        </div>

        <div class="form-group" id="groupDescription">
          <label for="playerDesc">Co ten gracz zrobił? (min. 10 słów)</label>
          <textarea id="playerDesc" name="playerDesc" autocomplete="off" required aria-required="true"></textarea>
          <div class="error-message" aria-live="polite"></div>
        </div>

        <button type="submit" id="submitComplaint">Wyślij skargę</button>
      </form>

      <!-- Podziękowanie - ukryte na start -->
      <div class="thankyou-message" id="thankyouMessage" style="display:none;">
        <p>Dziękujemy za złożenie skargi!</p>
        <a href="#" id="backToMain">Wróć na stronę główną</a>
      </div>

    </div>
  </div>

  <script>
    (() => {
      const openFormBtn = document.getElementById('openFormBtn');
      const modal = document.getElementById('complaintModal');
      const form = document.getElementById('complaintForm');
      const thankyouMessage = document.getElementById('thankyouMessage');
      const backToMainLink = document.getElementById('backToMain');

      const complaintsUl = document.getElementById('complaintsUl');

      const groupNick = document.getElementById('groupNick');
      const groupDesc = document.getElementById('groupDescription');

      const inputNick = document.getElementById('playerNick');
      const inputDesc = document.getElementById('playerDesc');

      // Brzydkie słowa - możesz dodać więcej
      const bannedWords = ['chuj', 'cwel', 'pizda', 'kurwa', 'jebac', 'spierdalaj', 'pierdol', 'skurwysyn'];

      // Lista skarg (przechowywana w pamięci strony)
      const complaints = [];

      // Pomocnik do formatowania daty
      function formatDate(date) {
        const d = date.getDate().toString().padStart(2,'0');
        const m = (date.getMonth()+1).toString().padStart(2,'0');
        const y = date.getFullYear();
        const hh = date.getHours().toString().padStart(2,'0');
        const mm = date.getMinutes().toString().padStart(2,'0');
        return `${d}.${m}.${y}, ${hh}:${mm}`;
      }

      // Walidacja brzydkich słów
      function containsBannedWords(text) {
        const textLower = text.toLowerCase();
        return bannedWords.some(word => textLower.includes(word));
      }

      // Walidacja formularza
      function validateForm() {
        let valid = true;

        // Czyszczenie poprzednich błędów
        groupNick.classList.remove('error');
        groupDesc.classList.remove('error');
        groupNick.querySelector('.error-message').textContent = '';
        groupDesc.querySelector('.error-message').textContent = '';

        // Nick - wymagany, nie pusty
        if (!inputNick.value.trim()) {
          groupNick.classList.add('error');
          groupNick.querySelector('.error-message').textContent = 'Musisz wpisać nick gracza!';
          valid = false;
        }

        // Opis - min 10 słów
        const words = inputDesc.value.trim().split(/\s+/).filter(w => w.length > 0);
        if (words.length < 10) {
          groupDesc.classList.add('error');
          groupDesc.querySelector('.error-message').textContent = 'Opis musi zawierać co najmniej 10 słów.';
          valid = false;
        } else if (containsBannedWords(inputDesc.value)) {
          groupDesc.classList.add('error');
          groupDesc.querySelector('.error-message').textContent = 'Opis zawiera niedozwolone słowa. Proszę zmienić treść.';
          valid = false;
        }

        return valid;
      }

      // Sprawdzenie, czy skarga już istnieje (unikalność)
      function isDuplicate(nick, desc) {
        const lowerNick = nick.trim().toLowerCase();
        const lowerDesc = desc.trim().toLowerCase();
        return complaints.some(c => c.nick.toLowerCase() === lowerNick && c.desc.toLowerCase() === lowerDesc);
      }

      // Dodanie skargi do listy i wyświetlenie
      function addComplaint(nick, desc) {
        const now = new Date();
        const timeStr = formatDate(now);

        const complaintObj = {
          nick: nick.trim(),
          desc: desc.trim(),
          time: timeStr,
          id: Date.now() + Math.random(), // unikalne ID
        };

        complaints.push(complaintObj);
        renderComplaints();
      }

      // Renderowanie listy skarg
      function renderComplaints() {
        complaintsUl.innerHTML = '';

        complaints.forEach(c => {
          const li = document.createElement('li');

          // Nick gracza
          const nickSpan = document.createElement('span');
          nickSpan.textContent = `Gracz: ${c.nick}`;
          nickSpan.classList.add('playerNick');
          li.appendChild(nickSpan);

          // Opis skargi
          const descText = document.createTextNode(c.desc);
          li.appendChild(descText);

          // Data i godzina
          const timeSpan = document.createElement('span');
          timeSpan.textContent = c.time;
          timeSpan.classList.add('time');
          li.appendChild(timeSpan);

          // Przycisk usuń
          const delBtn = document.createElement('button');
          delBtn.textContent = 'Usuń';
          delBtn.classList.add('deleteBtn');
          delBtn.setAttribute('aria-label', `Usuń skargę na ${c.nick}`);

          delBtn.addEventListener('click', () => {
            // Usuwamy skargę po ID
            const index = complaints.findIndex(item => item.id === c.id);
            if (index > -1) {
              complaints.splice(index, 1);
              renderComplaints();
            }
          });

          li.appendChild(delBtn);
          complaintsUl.appendChild(li);
        });
      }

      // Otwarcie modal
      openFormBtn.addEventListener('click', () => {
        modal.classList.add('active');
        form.style.display = 'block';
        thankyouMessage.style.display = 'none';

        inputNick.value = '';
        inputDesc.value = '';

        groupNick.classList.remove('error');
        groupDesc.classList.remove('error');
        groupNick.querySelector('.error-message').textContent = '';
        groupDesc.querySelector('.error-message').textContent = '';

        inputNick.focus();
      });

      // Zamykanie modala - kliknięcie w link "Wróć na stronę główną"
      backToMainLink.addEventListener('click', e => {
        e.preventDefault();
        modal.classList.remove('active');
        openFormBtn.focus();
      });

      // Obsługa formularza
      form.addEventListener('submit', e => {
        e.preventDefault();

        if (!validateForm()) {
          return;
        }

        const nick = inputNick.value.trim();
        const desc = inputDesc.value.trim();

        if (isDuplicate(nick, desc)) {
          groupDesc.classList.add('error');
          groupDesc.querySelector('.error-message').textContent = 'Taka skarga już została zgłoszona!';
          return;
        }

        addComplaint(nick, desc);

        // Pokaż podziękowanie, ukryj formularz
        form.style.display = 'none';
        thankyouMessage.style.display = 'block';
      });

      // Zamknij modal klikając poza modal-content
      modal.addEventListener('click', e => {
        if (e.target === modal) {
          modal.classList.remove('active');
          openFormBtn.focus();
        }
      });

      // Zamknięcie modala klawiszem ESC
      document.addEventListener('keydown', e => {
        if (e.key === 'Escape' && modal.classList.contains('active')) {
          modal.classList.remove('active');
          openFormBtn.focus();
        }
      });

    })();
  </script>

</body>
</html>
